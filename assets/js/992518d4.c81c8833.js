"use strict";(self.webpackChunkcra_docs=self.webpackChunkcra_docs||[]).push([[9541],{876:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var a=n(2784);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(n),d=o,h=p["".concat(l,".").concat(d)]||p[d]||m[d]||r;return n?a.createElement(h,i(i({ref:t},c),{},{components:n})):a.createElement(h,i({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:o,i[1]=s;for(var u=2;u<r;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2106:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return h},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return p}});var a=n(7896),o=n(1461),r=(n(2784),n(876)),i=["components"],s={id:"troubleshooting",title:"\u6545\u969c\u6392\u9664",sidebar_label:"\u6545\u969c\u6392\u9664"},l=void 0,u={unversionedId:"troubleshooting",id:"troubleshooting",title:"\u6545\u969c\u6392\u9664",description:"npm start doesn\u2019t detect changes",source:"@site/../docs/troubleshooting.md",sourceDirName:".",slug:"/troubleshooting",permalink:"/cra-docs/docs/troubleshooting",draft:!1,editUrl:"https://github.com/wdk-docs/cra-docs/edit/main/docusaurus/website/../docs/troubleshooting.md",tags:[],version:"current",lastUpdatedBy:"wohugb@aliyun.com",lastUpdatedAt:1689235792,formattedLastUpdatedAt:"2023\u5e747\u670813\u65e5",frontMatter:{id:"troubleshooting",title:"\u6545\u969c\u6392\u9664",sidebar_label:"\u6545\u969c\u6392\u9664"},sidebar:"docs",previous:{title:"\u55b7\u5c04\u7684\u66ff\u4ee3\u65b9\u6848",permalink:"/cra-docs/docs/alternatives-to-ejecting"}},c={},p=[{value:"<code>npm start</code> doesn\u2019t detect changes",id:"npm-start-doesnt-detect-changes",level:2},{value:"<code>npm start</code> fail due to watch error",id:"npm-start-fail-due-to-watch-error",level:2},{value:"<code>npm test</code> hangs or crashes on macOS Sierra",id:"npm-test-hangs-or-crashes-on-macos-sierra",level:2},{value:"<code>npm run build</code> exits too early",id:"npm-run-build-exits-too-early",level:2},{value:"<code>npm run build</code> fails on Heroku",id:"npm-run-build-fails-on-heroku",level:2},{value:"Moment.js locales are missing",id:"momentjs-locales-are-missing",level:2},{value:"<code>npm run build</code> fails to minify",id:"npm-run-build-fails-to-minify",level:2}],m={toc:p},d="wrapper";function h(e){var t=e.components,n=(0,o.Z)(e,i);return(0,r.kt)(d,(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"npm-start-doesnt-detect-changes"},(0,r.kt)("inlineCode",{parentName:"h2"},"npm start")," doesn\u2019t detect changes"),(0,r.kt)("p",null,"When you save a file while ",(0,r.kt)("inlineCode",{parentName:"p"},"npm start")," is running, the browser should refresh with the updated code."),(0,r.kt)("p",null,"If this doesn\u2019t happen, try one of the following workarounds:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Check that your file is imported by your entrypoint. TypeScript will show errors on any of your source files, but webpack only reloads your files if they are directly or indirectly imported by one of your entrypoints."),(0,r.kt)("li",{parentName:"ul"},"If your project is in a Dropbox folder, try moving it out."),(0,r.kt)("li",{parentName:"ul"},"If the watcher doesn\u2019t see a file called ",(0,r.kt)("inlineCode",{parentName:"li"},"index.js")," and you\u2019re referencing it by the folder name, you ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/facebook/create-react-app/issues/1164"},"need to restart the watcher")," due to a webpack bug."),(0,r.kt)("li",{parentName:"ul"},"Some editors like Vim and IntelliJ have a \u201csafe write\u201d feature that currently breaks the watcher. You will need to disable it. Follow the instructions in ",(0,r.kt)("a",{parentName:"li",href:"https://webpack.js.org/guides/development/#adjusting-your-text-editor"},"\u201cAdjusting Your Text Editor\u201d"),"."),(0,r.kt)("li",{parentName:"ul"},"If your project path contains parentheses, try moving the project to a path without them. This is caused by a ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/webpack/watchpack/issues/42"},"webpack watcher bug"),"."),(0,r.kt)("li",{parentName:"ul"},"On Linux and macOS, you might need to ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/webpack/docs/wiki/troubleshooting#not-enough-watchers"},"tweak system settings")," to allow more watchers."),(0,r.kt)("li",{parentName:"ul"},"If the project runs inside a virtual machine such as (a Vagrant provisioned) VirtualBox, create an ",(0,r.kt)("inlineCode",{parentName:"li"},".env")," file in your project directory if it doesn\u2019t exist, and add ",(0,r.kt)("inlineCode",{parentName:"li"},"CHOKIDAR_USEPOLLING=true")," to it. This ensures that the next time you run ",(0,r.kt)("inlineCode",{parentName:"li"},"npm start"),", the watcher uses the polling mode, as necessary inside a VM.")),(0,r.kt)("p",null,"If none of these solutions help please leave a comment ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/facebook/create-react-app/issues/659"},"in this thread"),"."),(0,r.kt)("h2",{id:"npm-start-fail-due-to-watch-error"},(0,r.kt)("inlineCode",{parentName:"h2"},"npm start")," fail due to watch error"),(0,r.kt)("p",null,"If you are using a Linux operating system and see an error similar to: ",(0,r.kt)("inlineCode",{parentName:"p"},"ENOSPC: System limit for number of file watchers reached"),", you can fix the issue by increasing the ",(0,r.kt)("inlineCode",{parentName:"p"},"fs.inotify.max_user_watches")," setting of your operating system."),(0,r.kt)("p",null,"If you are running Debian, RedHat, or another similar Linux distribution, run the following in a terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf && sudo sysctl -p\n")),(0,r.kt)("p",null,"If you are running ArchLinux, run the following command instead:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"echo fs.inotify.max_user_watches=524288 | sudo tee /etc/sysctl.d/40-max-user-watches.conf && sudo sysctl --system\n")),(0,r.kt)("p",null,"Then paste it in your terminal and press on enter to run it. You could find more information ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/guard/listen/wiki/Increasing-the-amount-of-inotify-watchers#the-technical-details"},"here"),"."),(0,r.kt)("h2",{id:"npm-test-hangs-or-crashes-on-macos-sierra"},(0,r.kt)("inlineCode",{parentName:"h2"},"npm test")," hangs or crashes on macOS Sierra"),(0,r.kt)("p",null,"If you run ",(0,r.kt)("inlineCode",{parentName:"p"},"npm test")," and the console gets stuck after printing ",(0,r.kt)("inlineCode",{parentName:"p"},"react-scripts test")," to the console there might be a problem with your ",(0,r.kt)("a",{parentName:"p",href:"https://facebook.github.io/watchman/"},"Watchman")," installation as described in ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/facebook/create-react-app/issues/713"},"facebook/create-react-app#713"),"."),(0,r.kt)("p",null,"We recommend deleting ",(0,r.kt)("inlineCode",{parentName:"p"},"node_modules")," in your project and running ",(0,r.kt)("inlineCode",{parentName:"p"},"npm install")," (or ",(0,r.kt)("inlineCode",{parentName:"p"},"yarn")," if you use it) first. If it doesn't help, you can try one of the numerous workarounds mentioned in these issues:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/facebook/jest/issues/1767"},"facebook/jest#1767")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/facebook/watchman/issues/358"},"facebook/watchman#358")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/ember-cli/ember-cli/issues/6259"},"ember-cli/ember-cli#6259"))),(0,r.kt)("p",null,"It is reported that installing Watchman 4.7.0 or newer fixes the issue. If you use ",(0,r.kt)("a",{parentName:"p",href:"https://brew.sh/"},"Homebrew"),", you can run these commands to update it:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"watchman shutdown-server\nbrew update\nbrew reinstall watchman\n")),(0,r.kt)("p",null,"You can find ",(0,r.kt)("a",{parentName:"p",href:"https://facebook.github.io/watchman/docs/install.html#build-install"},"other installation methods")," on the Watchman documentation page."),(0,r.kt)("p",null,"If this still doesn\u2019t help, try running ",(0,r.kt)("inlineCode",{parentName:"p"},"launchctl unload -F ~/Library/LaunchAgents/com.github.facebook.watchman.plist"),"."),(0,r.kt)("p",null,"There are also reports that ",(0,r.kt)("em",{parentName:"p"},"uninstalling")," Watchman fixes the issue. So if nothing else helps, remove it from your system and try again."),(0,r.kt)("h2",{id:"npm-run-build-exits-too-early"},(0,r.kt)("inlineCode",{parentName:"h2"},"npm run build")," exits too early"),(0,r.kt)("p",null,"It is reported that ",(0,r.kt)("inlineCode",{parentName:"p"},"npm run build")," can fail on machines with limited memory and no swap space, which is common in cloud environments. Even with small projects this command can increase RAM usage in your system by hundreds of megabytes, so if you have less than 1 GB of available memory your build is likely to fail with the following message:"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The build failed because the process exited too early. This probably means the system ran out of memory or someone called ",(0,r.kt)("inlineCode",{parentName:"p"},"kill -9")," on the process.")),(0,r.kt)("p",null,"If you are completely sure that you didn't terminate the process, consider ",(0,r.kt)("a",{parentName:"p",href:"https://www.digitalocean.com/community/tutorials/how-to-add-swap-on-ubuntu-14-04"},"adding some swap space")," to the machine you\u2019re building on, or build the project locally."),(0,r.kt)("h2",{id:"npm-run-build-fails-on-heroku"},(0,r.kt)("inlineCode",{parentName:"h2"},"npm run build")," fails on Heroku"),(0,r.kt)("p",null,"This may be a problem with case sensitive filenames.\nPlease refer to ",(0,r.kt)("a",{parentName:"p",href:"/cra-docs/docs/deployment#resolving-heroku-deployment-errors"},"this section"),"."),(0,r.kt)("h2",{id:"momentjs-locales-are-missing"},"Moment.js locales are missing"),(0,r.kt)("p",null,"If you use a ",(0,r.kt)("a",{parentName:"p",href:"https://momentjs.com/"},"Moment.js"),", you might notice that only the English locale is available by default. This is because the locale files are large, and you probably only need a subset of ",(0,r.kt)("a",{parentName:"p",href:"https://momentjs.com/#multiple-locale-support"},"all the locales provided by Moment.js"),"."),(0,r.kt)("p",null,"To add a specific Moment.js locale to your bundle, you need to import it explicitly."),(0,r.kt)("p",null,"For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import moment from 'moment';\nimport 'moment/locale/fr';\n")),(0,r.kt)("p",null,"If you are importing multiple locales this way, you can later switch between them by calling ",(0,r.kt)("inlineCode",{parentName:"p"},"moment.locale()")," with the locale name:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import moment from 'moment';\nimport 'moment/locale/fr';\nimport 'moment/locale/es';\n\n// ...\n\nmoment.locale('fr');\n")),(0,r.kt)("p",null,"This will only work for locales that have been explicitly imported before."),(0,r.kt)("h2",{id:"npm-run-build-fails-to-minify"},(0,r.kt)("inlineCode",{parentName:"h2"},"npm run build")," fails to minify"),(0,r.kt)("p",null,"Before ",(0,r.kt)("inlineCode",{parentName:"p"},"react-scripts@2.0.0"),", this problem was caused by third party ",(0,r.kt)("inlineCode",{parentName:"p"},"node_modules")," using modern JavaScript features because the minifier couldn't handle them during the build. This has been solved by compiling standard modern JavaScript features inside ",(0,r.kt)("inlineCode",{parentName:"p"},"node_modules")," in ",(0,r.kt)("inlineCode",{parentName:"p"},"react-scripts@2.0.0")," and higher."),(0,r.kt)("p",null,"If you're seeing this error, you're likely using an old version of ",(0,r.kt)("inlineCode",{parentName:"p"},"react-scripts"),". You can either fix it by avoiding a dependency that uses modern syntax, or by upgrading to ",(0,r.kt)("inlineCode",{parentName:"p"},"react-scripts@>=2.0.0")," and following the migration instructions in the changelog."))}h.isMDXComponent=!0}}]);